webpackJsonp([1],{"6lva":function(t,n){t.exports={icon:"_2PvK_yMaZIaxf2MVo3byc8_0","icon-image":"ZnsePKM6Rcyq8ohap6uUK_0","icon-upload":"_2Fat5V5jTSQbMCy-c_NhO1_0","icon-hexagon":"_2q9AP0SC09VCLwD0LPtQSU_0","icon-return":"_2l3TyGgwtB_zyr6JFmMYTq_0","icon-return-2":"_3ALov8O8Fqi9RxftPaDwtW_0","icon-font":"_1SBEuMvw5TDM87dmfTnNc5_0","icon-drawing":"fT0s_G628kEHsHnE5wVZH_0","icon-brightness":"_2HAqOLhMFrrzWW-FkbfSUp_0","icon-contrast":"_1PHaMitmUWxOLOKKDycpjU_0","icon-arrow":"kdXltl9SBzoC6A30CVviB_0","icon-airplane":"_2oOUcQIai67d1BYibOT6RZ_0","icon-success":"_2S9J7aGEFk4O7-zD4Fv79b_0","icon-angle":"_1dnIH7rfC0l0bgbSD36Gek_0","icon-round":"_1iCFb4aMV0bARr_2zlJMX0_0","icon-delete":"_2Y4waixvz80XH2fFpGU4Kr_0","icon-add":"_2zVQ9WqFyd7XQYDDQzzDc3_0","icon-setting":"_2M4pCJU5giZQDfMQyjKvZN_0",header:"_3a2Ly0d3uEFotK3sMjvRRb_0",tabs:"DiMbDt8qvNHCA07HwvcUa_0",tab_item:"_2HDrIWaD1d2ZI1eLvEGyB5_0",active:"_1UWsJezUtPHlpD1EQu7Tz6_0"}},CZUG:function(t,n){t.exports={app:"_7GWKZZxRyNF89VUa_LE90_0"}},"Dl+Q":function(t,n){},HrNf:function(t,n){t.exports={icon:"_2cUV5VylbTfV8iyrK7c-Z5_0","icon-image":"_3mgboV-L-Or37JoKOYZLkS_0","icon-upload":"_3YhtKRy03ZAsceuz4NQYpW_0","icon-hexagon":"_3IEx3Zn9g7RH20Zpe6xwcw_0","icon-return":"CairNORpzmOPY4sIn4TcJ_0","icon-return-2":"_3EAS5pLp8pGxx5OCcBRSdc_0","icon-font":"_3grgwOxc6FHnMDXyY_T775_0","icon-drawing":"VC-ad-sNYipI-PYNHyfr6_0","icon-brightness":"_1hsRE7HYHv_iJfGE2W_Lhj_0","icon-contrast":"_3lgTk0Q-VKe1diPHFk3fPH_0","icon-arrow":"efowlHGcx-jaI3dGQ08rr_0","icon-airplane":"SDICAyw3aS204-chq6q3L_0","icon-success":"_3ow9gV-_2TpaWEpu3GaUxT_0","icon-angle":"Ig_3WSDDfxrGybBHwPajI_0","icon-round":"_2mlrr4_EY1atjWXD_qTXCW_0","icon-delete":"_1qipPwZlbCtpLUOJhqI2pd_0","icon-add":"_21u87CxTcLxlBeKG8IQKF8_0","icon-setting":"_3MuNciJ16TV_uQqmnGxPBz_0",leftBox:"_5x1ba_gc0BDjECzxPJU8b_0",fontBox:"_3BiPpPKkLCCfhdO6oZUeBe_0",waper:"_1dlT5D0kjwqJ-bBOmI0-lg_0",canvas:"_7sg5ukifasfdchVvc_Psp_0",canvas_waper:"_1bOFcbBevg4IhEJOTSGh0c_0",upload:"_3GD6A9jmO7N4mAX3lgwXcl_0",file_input:"_1nb7TTjs7JXZtCuKayIloc_0",upload_text:"_45Ef97zl7u-t_d5lc9o3M_0",range_warper:"_1-4SKiAaa0f-PJ6UizJT98_0",icon_center:"_q1ePBc7-TsFv392R6Oc0_0",button_warper:"lN46uXxFzAZE1BZddeWUo_0",popup:"dOAsZq4qpA6cTj4vz5QQm_0",background_000:"_1JzCr4r6ep1K0U6SPfaFpX_0",background_ccc:"_3FL812pcFrLoCNNIo6hn82_0",background_fff:"QafgZ9AB3N6heFZ4Fcvsc_0",item:"_2VV7IXtdVo9JEdaZdxz1hh_0",rightBox:"_3F8B3F9J4Ipuw6VtzFk6XP_0",fontSize:"_2StawJQnytfAHBFX_FzAia_0",active:"_1OnQxtGzSn9HwrUw56gCZ0_0",tool_box:"_18a214l0ZkAZ6qyy4ojyW7_0",padding:"_3B0X2vsRtIyd0bS2Ewp364_0"}},MPzD:function(t,n){},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=e("/5sW"),s=e("bOdI"),c=e.n(s),o=e("Xxa5"),l=e.n(o),r=e("exGp"),h=e.n(r),d=(e("OgVB"),e("/Lyv")),_=e.n(d),u=(e("Dl+Q"),e("60Ef")),f=e.n(u),v=(e("y+mr"),e("3JdW")),g=e.n(v),m=e("rxKx"),p=e.n(m),x={components:(a={},c()(a,g.a.name,g.a),c()(a,f.a.name,f.a),c()(a,_.a.name,_.a),a),props:{value:{type:Number,default:0}},name:"x-canvas",data:function(){return{noFont:!0,canvas:null,ctx:null,hammertime:null,dx:null,dy:null,dWidth:null,dHeight:null,width:null,height:null,load:!1,image:new Image,scale:1,canText:!1,brightness:100,invert:0,contrast:100,noPan:!1,deg:0,text:"",fontColor:"#000000",deltaY:0,deltaX:0,fontSize:40}},methods:{drawImage:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.scale,e=this.deg,a=this.canvas.width/2,i=this.canvas.height/2;t&&(this.deltaX=this.deltaY=0),this.ctx.save(),this.ctx.clearRect(0,0,2*a,2*i),this.ctx.translate(a,i),this.ctx.rotate(Math.PI/180*e),this.ctx.scale(n,n),this.ctx.translate(-a,-i),this.ctx.filter="contrast("+this.contrast+"%) brightness("+this.brightness+"%) invert("+this.invert+"%)",this.ctx.translate(this.deltaX,this.deltaY),this.ctx.drawImage(this.image,this.dx,this.dy,this.dWidth,this.dHeight),this.ctx.restore(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.fillStyle=this.fontColor,this.ctx.font=this.fontSize+"px bolder serif",this.ctx.fillText(this.text,a,i),this.ctx.restore()},drawText:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.drawImage()},changeColor:function(t){this.fontColor=t,this.drawText()},changeBrightness:function(t){this.brightness=t,this.drawImage()},initCanvas:function(){var t=this;this.$nextTick(function(){t.canvas=t.$refs.canvas,t.ctx=t.$refs.canvas.getContext("2d"),t.canvasClip(),t.initHammer()})},fileData:function(t){try{this.image.src=URL.createObjectURL(t.target.files[0])}catch(t){console.log(t)}},initHammer:function(){var t=this;window.requestAnimationFrame(function(){t.hammertime=new p.a.Manager(t.$refs.canvas),t.hammertime.add(new p.a.Pan({direction:p.a.DIRECTION_ALL,threshold:0})),t.hammertime.add(new p.a.Pinch({enable:!0})),t.hammertime.on("pan",t.panLisener),t.hammertime.on("panend",t.panEnd),t.hammertime.on("pinchin",t.pinchIn),t.hammertime.on("pinchout",t.pinchOut),t.canvas.addEventListener("click",t.setText)})},setText:function(t){console.log(t)},panEnd:function(t){this.noPan||(this.dx+=t.deltaX,this.dy+=t.deltaY)},pinchIn:function(t){this.noPan||this.scale<=.3||(this.scale-=.03,this.drawImage())},pinchOut:function(t){this.noPan||this.scale>=2.5||(this.scale+=.03,this.drawImage())},canvasClip:function(){this.ctx.beginPath(),this.ctx.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2,0,2*Math.PI,!0),this.ctx.clip()},initCanvasImage:function(){this.dx=this.canvas.width/2-this.image.width/2,this.dy=this.canvas.height/2-this.image.height/2,this.ctx.drawImage(this.image,this.dx,this.dy),this.load=!0,this.$emit("loadImage",!0)},imageOnload:function(){var t=this;this.image.addEventListener("load",function(n){t.dWidth=t.width=t.image.width,t.dHeight=t.height=t.image.height,t.initCanvasImage()},!1)},changeModle:function(){console.log(this.noFont),this.noFont?(this.text="添加文字",this.getText()):this.text="",this.noFont=!this.noFont},panLisener:function(t){this.noPan||t.additionalEvent&&(this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.drawImage(!1))},getText:function(){var t=this;_.a.prompt("请输入文字","").then(function(n){var e=n.value;n.action;t.text=e}).catch(function(t){return console.log(t)})},fetchImage:function(){var t=this;return h()(l.a.mark(function n(){var e;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=new FormData,t.canvas.toBlob(function(){var n=h()(l.a.mark(function n(a){var i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.append("image",a,"$image-"+Date.now()+".png"),console.log(a),t.next=4,fetch("http://192.168.1.107:3000/",{method:"POST",body:e,mode:"no-cors"});case 4:i=t.sent,console.log(i);case 6:case"end":return t.stop()}},n,t)}));return function(t){return n.apply(this,arguments)}}());case 2:case"end":return n.stop()}},n,t)}))()},addText:function(t){this.showPopup=!0},closePopup:function(){this.showPopup=!1,this.drawImage()}},created:function(){this.initCanvas(),this.imageOnload()},computed:{canDr:function(){return!!this.canText||!this.load}},watch:{deg:function(){this.drawImage()},brightness:function(){this.drawImage()},contrast:function(){this.drawImage()},value:function(t){4===t&&(this.text="添加文字"),0!==t?this.noPan=!0:(this.noPan=!1,this.deg=0,this.text="",this.initCanvasImage())},text:function(){this.drawText()},fontSize:function(){this.drawText()}}},y={render:function(){var t,n,e,a,i=this,s=i.$createElement,c=i._self._c||s;return c("div",{class:i.$style.waper},[c("div",{class:i.$style.canvas_waper},[c("canvas",{ref:"canvas",class:i.$style.canvas,attrs:{width:"300px",height:"300px"}}),i._v(" "),i.load?i._e():c("div",{class:[i.$style.upload,i.$style["icon-upload"],i.$style.icon]},[c("span",{class:i.$style.upload_text},[i._v("上传文件")]),i._v(" "),c("input",{class:i.$style.file_input,attrs:{type:"file",name:"image",id:"",accept:"image/*"},on:{change:i.fileData}})])]),i._v(" "),4===i.value?c("div",{class:i.$style.fontBox},[c("div",{class:i.$style.leftBox},[c("div",{class:(t={},t[i.$style.item]=!0,t[i.$style.active]="#000000"===i.fontColor,t)},[c("span",{class:[i.$style.background_000],on:{click:function(t){i.changeColor("#000000")}}},[i._v(">")])]),i._v(" "),c("div",{class:(n={},n[i.$style.item]=!0,n[i.$style.active]="#cccccc"===i.fontColor,n)},[c("span",{class:[i.$style.background_ccc],on:{click:function(t){i.changeColor("#cccccc")}}})]),i._v(" "),c("div",{class:(e={},e[i.$style.item]=!0,e[i.$style.active]="#ffffff"===i.fontColor,e)},[c("span",{class:[i.$style.background_fff],on:{click:function(t){i.changeColor("#ffffff")}}})])]),i._v(" "),c("div",{class:i.$style.rightBox},[c("span",{class:(a={},a[i.$style.icon]=!0,a[i.$style["icon-add"]]=i.noFont,a[i.$style.fontSize]=!0,a[i.$style["icon-angle"]]=!i.noFont,a),on:{click:i.changeModle}})]),i._v(" "),c("div",{class:i.$style.tool_box},[c("mt-range",{attrs:{barHeight:2,min:10,max:40,step:1,value:"40"},model:{value:i.fontSize,callback:function(t){i.fontSize=t},expression:"fontSize"}},[c("div",{attrs:{slot:"start"},slot:"start"},[c("i",{class:[i.$style.icon,i.$style["icon-font"],i.$style.icon_center]})])])],1)]):i._e(),i._v(" "),i.canText?i._e():c("div",[0===i.value?c("div",{class:i.$style.tool_box}):i._e(),i._v(" "),1===i.value?c("div",{class:i.$style.tool_box},[c("mt-range",{attrs:{barHeight:2,min:-180,max:180,step:1},model:{value:i.deg,callback:function(t){i.deg=t},expression:"deg"}},[c("div",{attrs:{slot:"start"},slot:"start"},[c("i",{class:[i.$style.icon,i.$style["icon-angle"],i.$style.icon_center]})])])],1):i._e(),i._v(" "),2===i.value?c("div",{class:i.$style.tool_box},[c("mt-range",{attrs:{barHeight:2,min:30,max:200,step:1,value:"100"},model:{value:i.brightness,callback:function(t){i.brightness=t},expression:"brightness"}},[c("div",{attrs:{slot:"start"},slot:"start"},[c("i",{class:[i.$style.icon,i.$style["icon-brightness"],i.$style.icon_center]})])])],1):i._e(),i._v(" "),3===i.value?c("div",{class:i.$style.tool_box},[c("mt-range",{attrs:{barHeight:2,min:0,max:200,step:1,value:"100"},model:{value:i.contrast,callback:function(t){i.contrast=t},expression:"contrast"}},[c("div",{attrs:{slot:"start"},slot:"start"},[c("i",{class:[i.$style.icon,i.$style["icon-contrast"],i.$style.icon_center]})])])],1):i._e(),i._v(" "),c("div",{class:i.$style.padding},[c("mt-button",{attrs:{disabled:i.canDr,type:"primary",size:"large"},on:{click:i.fetchImage}},[i._v("提交")])],1)])])},staticRenderFns:[]};var $,b=e("VU/8")(x,y,!1,function(t){this.$style=e("HrNf")},null,null).exports,w=(e("XDqQ"),e("Axha")),I=e.n(w),C={components:($={},c()($,I.a.name,I.a),c()($,g.a.name,g.a),$),name:"x-header",props:{canChange:{type:Boolean,default:!1}},data:function(){return{value:0}},methods:{change:function(t){this.canChange&&(this.value=t,this.$emit("changvalue",t))}}},T={render:function(){var t,n,e,a,i,s=this,c=s.$createElement,o=s._self._c||c;return o("header",{class:s.$style.header},[s._m(0),s._v(" "),o("div",{class:s.$style.tabs},[o("span",{class:(t={},t[s.$style.tab_item]=!0,t[s.$style.active]=0===s.value,t),on:{click:function(t){s.change(0)}}},[o("i",{class:[s.$style.icon,s.$style["icon-arrow"]]})]),s._v(" "),o("span",{class:(n={},n[s.$style.tab_item]=!0,n[s.$style.active]=1===s.value,n),on:{click:function(t){s.change(1)}}},[o("i",{class:[s.$style.icon,s.$style["icon-angle"]]})]),s._v(" "),o("span",{class:(e={},e[s.$style.tab_item]=!0,e[s.$style.active]=2===s.value,e),on:{click:function(t){s.change(2)}}},[o("i",{class:[s.$style.icon,s.$style["icon-brightness"]]})]),s._v(" "),o("span",{class:(a={},a[s.$style.tab_item]=!0,a[s.$style.active]=3===s.value,a),on:{click:function(t){s.change(3)}}},[o("i",{class:[s.$style.icon,s.$style["icon-contrast"]]})]),s._v(" "),o("span",{class:(i={},i[s.$style.tab_item]=!0,i[s.$style.active]=4===s.value,i),on:{click:function(t){s.change(4)}}},[o("i",{class:[s.$style.icon,s.$style["icon-font"]]})])])])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("span",[n("i",{staticClass:"mintui mintui-back"})])}]};var P=e("VU/8")(C,T,!1,function(t){this.$style=e("6lva")},null,null).exports,F={components:c()({xCanvas:b},P.name,P),name:"app",data:function(){return{value:0,load:!1}},methods:{changeValue:function(t){console.log(t),this.value=t},loadImage:function(t){this.load=t}}},k={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{class:this.$style.app},[n("x-header",{attrs:{canChange:this.load},on:{changvalue:this.changeValue}}),this._v(" "),n("x-canvas",{attrs:{value:this.value},on:{loadImage:this.loadImage}})],1)},staticRenderFns:[]};var D=e("VU/8")(F,k,!1,function(t){this.$style=e("CZUG"),e("Z+Do")},null,null).exports;e("MPzD");i.default.config.productionTip=!1,new i.default({el:"#app",render:function(t){return t(D)}})},OgVB:function(t,n){},XDqQ:function(t,n){},"Z+Do":function(t,n){},joTY:function(t,n){},"y+mr":function(t,n){}},["NHnr"]);
//# sourceMappingURL=app.2ad81b1028b20bb7ccee.js.map