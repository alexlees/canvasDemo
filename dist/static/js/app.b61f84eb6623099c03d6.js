webpackJsonp([1],{Coyv:function(t,n){t.exports={icon:"_2cUV5VylbTfV8iyrK7c-Z5_0","icon-image":"_3mgboV-L-Or37JoKOYZLkS_0","icon-upload":"_3YhtKRy03ZAsceuz4NQYpW_0","icon-hexagon":"_3IEx3Zn9g7RH20Zpe6xwcw_0","icon-return":"CairNORpzmOPY4sIn4TcJ_0","icon-return-2":"_3EAS5pLp8pGxx5OCcBRSdc_0","icon-font":"_3grgwOxc6FHnMDXyY_T775_0","icon-drawing":"VC-ad-sNYipI-PYNHyfr6_0","icon-brightness":"_1hsRE7HYHv_iJfGE2W_Lhj_0","icon-contrast":"_3lgTk0Q-VKe1diPHFk3fPH_0","icon-arrow":"efowlHGcx-jaI3dGQ08rr_0","icon-airplane":"SDICAyw3aS204-chq6q3L_0","icon-success":"_3ow9gV-_2TpaWEpu3GaUxT_0","icon-angle":"Ig_3WSDDfxrGybBHwPajI_0","icon-round":"_2mlrr4_EY1atjWXD_qTXCW_0","icon-delete":"_1qipPwZlbCtpLUOJhqI2pd_0","icon-add":"_21u87CxTcLxlBeKG8IQKF8_0","icon-setting":"_3MuNciJ16TV_uQqmnGxPBz_0",canvas:"_7sg5ukifasfdchVvc_Psp_0",canvas_waper:"_1bOFcbBevg4IhEJOTSGh0c_0",upload:"_3GD6A9jmO7N4mAX3lgwXcl_0",file_input:"_1nb7TTjs7JXZtCuKayIloc_0",upload_text:"_45Ef97zl7u-t_d5lc9o3M_0",range_warper:"_1-4SKiAaa0f-PJ6UizJT98_0",icon_center:"_q1ePBc7-TsFv392R6Oc0_0",button_warper:"lN46uXxFzAZE1BZddeWUo_0",popup:"dOAsZq4qpA6cTj4vz5QQm_0"}},"Dl+Q":function(t,n){},MPzD:function(t,n){},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=e("/5sW"),s=e("Xxa5"),c=e.n(s),o=e("exGp"),r=e.n(o),l=e("bOdI"),h=e.n(l),d=(e("goBr"),e("IBPZ")),u=e.n(d),p=(e("f1Vh"),e("ZQVe")),m=e.n(p),f=(e("q/am"),e("4VPn")),_=e.n(f),g=(e("Dl+Q"),e("60Ef")),v=e.n(g),x=(e("y+mr"),e("3JdW")),w=e.n(x),y=e("rxKx"),b=e.n(y),I={components:(a={},h()(a,w.a.name,w.a),h()(a,v.a.name,v.a),h()(a,_.a.name,_.a),h()(a,m.a.name,m.a),h()(a,u.a.name,u.a),a),name:"x-canvas",data:function(){return{canvas:null,ctx:null,hammertime:null,dx:null,dy:null,dWidth:null,dHeight:null,width:null,height:null,load:!1,image:new Image,scale:1,canText:!1,brightness:100,invert:0,contrast:100,noPan:!1,deg:0,text:"",fontColor:"#ffffff",deltaY:0,deltaX:0,fontSize:20,showPopup:!1,colorS:[{label:"红色",value:"red"},{label:"白色",value:"#ffffff"},{label:"黑色",value:"black"}]}},methods:{drawImage:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this.scale,e=this.deg,a=this.canvas.width/2,i=this.canvas.height/2;t&&(this.deltaX=this.deltaY=0),this.ctx.save(),this.ctx.clearRect(0,0,2*a,2*i),this.ctx.translate(a,i),this.ctx.rotate(Math.PI/180*e),this.ctx.scale(n,n),this.ctx.translate(-a,-i),this.ctx.filter="contrast("+this.contrast+"%) brightness("+this.brightness+"%) invert("+this.invert+"%)",this.ctx.drawImage(this.image,this.dx+this.deltaX,this.dy+this.deltaY,this.dWidth,this.dHeight),this.ctx.restore(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.fillStyle=this.fontColor,this.ctx.font=this.fontSize+"px bold serif",this.ctx.fillText(this.text,a,i),this.ctx.restore()},changeBrightness:function(t){this.brightness=t,this.drawImage()},initCanvas:function(){var t=this;this.$nextTick(function(){t.canvas=t.$refs.canvas,t.ctx=t.$refs.canvas.getContext("2d"),t.canvasClip(),t.initHammer()})},fileData:function(t){try{this.image.src=URL.createObjectURL(t.target.files[0])}catch(t){console.log(t)}},initHammer:function(){var t=this;window.requestAnimationFrame(function(){t.hammertime=new b.a.Manager(t.$refs.canvas),t.hammertime.add(new b.a.Pan({direction:b.a.DIRECTION_ALL,threshold:0})),t.hammertime.add(new b.a.Pinch({enable:!0})),t.hammertime.on("pan",t.panLisener),t.hammertime.on("panend",t.panEnd),t.hammertime.on("pinchin",t.pinchIn),t.hammertime.on("pinchout",t.pinchOut)})},panEnd:function(t){this.noPan||(this.dx+=t.deltaX,this.dy+=t.deltaY)},pinchIn:function(t){this.noPan||this.scale<=.3||(this.scale-=.03,this.drawImage())},pinchOut:function(t){this.noPan||this.scale>=2.5||(this.scale+=.03,this.drawImage())},canvasClip:function(){this.ctx.beginPath(),this.ctx.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2,0,2*Math.PI,!0),this.ctx.clip()},initCanvasImage:function(){this.dx=this.canvas.width/2-this.image.width/2,this.dy=this.canvas.height/2-this.image.height/2,this.ctx.drawImage(this.image,this.dx,this.dy),this.load=!0},imageOnload:function(){var t=this;this.image.addEventListener("load",function(n){t.dWidth=t.width=t.image.width,t.dHeight=t.height=t.image.height,t.initCanvasImage()},!1)},panLisener:function(t){this.noPan||t.additionalEvent&&(console.log("deltaX",t.deltaX),console.log("deltaY",t.deltaY),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.drawImage(!1))},getText:function(){this.canText=!0,this.noPan=!0},fetchImage:function(){var t=this;return r()(c.a.mark(function n(){var e;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=new FormData,t.canvas.toBlob(function(){var n=r()(c.a.mark(function n(a){var i;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.append("image",a,"$image-"+Date.now()+".png"),console.log(a),t.next=4,fetch("http://192.168.1.107:3000/",{method:"POST",body:e,mode:"no-cors"});case 4:i=t.sent,console.log(i);case 6:case"end":return t.stop()}},n,t)}));return function(t){return n.apply(this,arguments)}}());case 2:case"end":return n.stop()}},n,t)}))()},addText:function(t){this.showPopup=!0},closePopup:function(){this.showPopup=!1,this.drawImage()}},created:function(){this.initCanvas(),this.imageOnload()},computed:{canDr:function(){return!!this.canText||!this.load}},watch:{deg:function(){this.drawImage()},brightness:function(){this.drawImage()},contrast:function(){this.drawImage()}}},P={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{class:t.$style.waper},[e("mt-popup",{class:t.$style.popup,attrs:{position:"right"},model:{value:t.showPopup,callback:function(n){t.showPopup=n},expression:"showPopup"}},[e("mt-field",{attrs:{label:"文字",placeholder:"请添加文字",type:"textarea",rows:"2"},model:{value:t.text,callback:function(n){t.text=n},expression:"text"}}),t._v(" "),e("mt-range",{attrs:{min:10,max:40,step:1,value:"20"},model:{value:t.fontSize,callback:function(n){t.fontSize=n},expression:"fontSize"}},[e("div",{class:[t.$style.icon_center],attrs:{slot:"start"},slot:"start"},[t._v("字体大小")])]),t._v(" "),e("mt-radio",{attrs:{title:"字体颜色",options:t.colorS},model:{value:t.fontColor,callback:function(n){t.fontColor=n},expression:"fontColor"}}),t._v(" "),e("mt-button",{attrs:{type:"primary",size:"large"},on:{click:t.closePopup}},[t._v("确定")])],1),t._v(" "),e("div",{class:t.$style.canvas_waper},[e("canvas",{ref:"canvas",class:t.$style.canvas,attrs:{width:"300px",height:"300px"}}),t._v(" "),t.load?t._e():e("div",{class:[t.$style.upload,t.$style["icon-upload"],t.$style.icon]},[e("span",{class:t.$style.upload_text},[t._v("上传文件")]),t._v(" "),e("input",{class:t.$style.file_input,attrs:{type:"file",name:"image",id:"",accept:"image/*"},on:{change:t.fileData}})])]),t._v(" "),t.canText?t._e():e("div",[t.canText?t._e():e("mt-button",{attrs:{disabled:t.canDr,type:"primary",size:"large"},on:{click:t.getText}},[t._v("下一步")])],1),t._v(" "),t.canText?e("div",{class:t.$style.range_warper},[e("mt-range",{attrs:{min:-180,max:180,step:1},model:{value:t.deg,callback:function(n){t.deg=n},expression:"deg"}},[e("div",{attrs:{slot:"start"},slot:"start"},[e("i",{class:[t.$style.icon,t.$style["icon-angle"],t.$style.icon_center]})])]),t._v(" "),e("mt-range",{attrs:{min:30,max:200,step:1,value:"100"},model:{value:t.brightness,callback:function(n){t.brightness=n},expression:"brightness"}},[e("div",{attrs:{slot:"start"},slot:"start"},[e("i",{class:[t.$style.icon,t.$style["icon-brightness"],t.$style.icon_center]})])]),t._v(" "),e("mt-range",{attrs:{min:0,max:200,step:1,value:"100"},model:{value:t.contrast,callback:function(n){t.contrast=n},expression:"contrast"}},[e("div",{attrs:{slot:"start"},slot:"start"},[e("i",{class:[t.$style.icon,t.$style["icon-contrast"],t.$style.icon_center]})])]),t._v(" "),e("div",{class:t.$style.button_warper},[e("mt-button",{attrs:{type:"primary"},on:{click:t.addText}},[t._v("添加文字")]),t._v(" "),e("mt-button",{attrs:{type:"primary"},on:{click:t.fetchImage}},[t._v("上传图片")])],1)],1):t._e()],1)},staticRenderFns:[]};var T={components:{xCanvas:e("VU/8")(I,P,!1,function(t){this.$style=e("Coyv")},null,null).exports},name:"app",data:function(){return{}}},$={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{class:this.$style.app},[n("x-canvas")],1)},staticRenderFns:[]};var C=e("VU/8")(T,$,!1,function(t){this.$style=e("dj4J"),e("T/IY")},null,null).exports;e("MPzD");i.default.config.productionTip=!1,new i.default({el:"#app",render:function(t){return t(C)}})},"T/IY":function(t,n){},dj4J:function(t,n){t.exports={app:"_7GWKZZxRyNF89VUa_LE90_0"}},f1Vh:function(t,n){},goBr:function(t,n){},joTY:function(t,n){},lrMw:function(t,n){},"q/am":function(t,n){},"y+mr":function(t,n){}},["NHnr"]);
//# sourceMappingURL=app.b61f84eb6623099c03d6.js.map